<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="OLDA Atelier — Boutique B2B de souvenirs premium Saint-Martin">
    <meta name="theme-color" content="#ffffff">
    <title>OLDA Atelier | Boutique Officielle</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root {
            --white: #ffffff;
            --off-white: #fdfcfa;
            --sand: #f5f1eb;
            --sand-dark: #e8e2d9;
            --black: #1d1d1f;
            --charcoal: #2c2c2e;
            --ocean: #0a7ea4;
            --ocean-light: #e6f4f8;
            --tropique: #2d6a4f;
            --gray: #86868b;
            --gray-light: #aeaeb2;
            --border: #e5e5e5;
            --border-light: #f2f2f2;
            --discount: #bf4800;
            --discount-light: #fff8f5;
            --font-main: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: var(--font-main); background-color: var(--white); color: var(--black); line-height: 1.47; -webkit-font-smoothing: antialiased; overflow-x: hidden; }

        /* Header */
        header { position: sticky; top: 0; z-index: 1000; background: rgba(255,255,255,0.8); backdrop-filter: saturate(180%) blur(20px); -webkit-backdrop-filter: saturate(180%) blur(20px); border-bottom: 1px solid var(--border-light); }
        .header-content { max-width: 1024px; margin: 0 auto; height: 52px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        .logo { font-size: 20px; font-weight: 600; letter-spacing: -0.02em; cursor: pointer; color: var(--black); text-decoration: none; }

        /* Navigation */
        .nav-main-scroll { border-bottom: 1px solid var(--border-light); background: var(--white); overflow-x: auto; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
        .nav-main-scroll::-webkit-scrollbar { display: none; }
        .nav-main { max-width: 1024px; margin: 0 auto; display: flex; height: 48px; padding: 0 10px; }
        .nav-item { padding: 0 15px; display: flex; align-items: center; font-size: 14px; color: var(--charcoal); cursor: pointer; white-space: nowrap; transition: color 0.2s; position: relative; font-weight: 400; }
        .nav-item:hover { color: var(--ocean); }
        .nav-item.active { color: var(--ocean); font-weight: 600; }
        .nav-item.active::after { content: ''; position: absolute; bottom: 0; left: 15px; right: 15px; height: 2px; background: var(--ocean); }
        .nav-item.is-discount { color: var(--discount); }

        .nav-sub-scroll { background: var(--sand); overflow-x: auto; scrollbar-width: none; }
        .nav-sub-scroll::-webkit-scrollbar { display: none; }
        .nav-sub { max-width: 1024px; margin: 0 auto; display: flex; height: 44px; padding: 0 10px; }
        .sub-item { padding: 0 15px; display: flex; align-items: center; font-size: 13px; color: var(--charcoal); cursor: pointer; white-space: nowrap; }
        .sub-item.active { color: var(--black); font-weight: 600; }

        /* Main Content */
        main { max-width: 1024px; margin: 0 auto; padding: 40px 20px; min-height: 80vh; }
        .section-header { margin-bottom: 30px; }
        .section-header h1 { font-size: 32px; font-weight: 600; letter-spacing: -0.01em; margin-bottom: 8px; }
        .section-header p { color: var(--gray); font-size: 17px; }

        /* Grid */
        .product-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
        @media (max-width: 834px) { .product-grid { grid-template-columns: repeat(2, 1fr); gap: 20px; } }
        @media (max-width: 550px) { .product-grid { grid-template-columns: 1fr; gap: 15px; } }

        /* Card */
        .card { background: var(--white); border-radius: 18px; overflow: hidden; display: flex; flex-direction: column; transition: transform 0.3s ease, box-shadow 0.3s ease; border: 1px solid var(--border-light); }
        .card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.08); }
        
        .image-container { position: relative; padding-top: 100%; background: var(--sand); overflow: hidden; }
        .image-container img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .card:hover img { transform: scale(1.05); }

        .card-content { padding: 20px; display: flex; flex-direction: column; gap: 8px; }
        .product-ref { font-size: 12px; font-weight: 600; color: var(--ocean); text-transform: uppercase; letter-spacing: 0.05em; }
        .product-name { font-size: 19px; font-weight: 600; color: var(--black); margin-bottom: 2px; }
        .product-detail { font-size: 14px; color: var(--gray); margin-bottom: 4px; }

        /* Quantity Controls */
        .qty-wrapper { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-light); display: flex; align-items: center; justify-content: space-between; }
        .qty-input-group { display: flex; align-items: center; background: var(--sand); border-radius: 10px; padding: 4px; }
        .qty-btn { width: 32px; height: 32px; border-radius: 8px; border: none; background: var(--white); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: background 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .qty-btn:active { transform: scale(0.95); background: var(--sand-dark); }
        .qty-value { width: 44px; text-align: center; font-weight: 600; font-size: 15px; border: none; background: transparent; }
        .qty-step { font-size: 11px; color: var(--gray); font-weight: 500; }

        /* Cart UI */
        .cart-toggle { position: relative; background: var(--black); color: var(--white); border: none; border-radius: 20px; padding: 6px 16px; font-size: 13px; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: transform 0.2s; }
        .cart-toggle:active { transform: scale(0.98); }
        .cart-count { background: var(--white); color: var(--black); border-radius: 10px; min-width: 20px; padding: 0 6px; height: 20px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 11px; }

        /* Modal Cart */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); z-index: 2000; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .cart-panel { position: fixed; top: 0; right: 0; bottom: 0; width: 440px; background: var(--white); z-index: 2001; transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; box-shadow: -10px 0 30px rgba(0,0,0,0.1); }
        .modal-overlay.visible .cart-panel { transform: translateX(0); }
        @media (max-width: 440px) { .cart-panel { width: 100%; } }

        .cart-header { padding: 24px; border-bottom: 1px solid var(--border-light); display: flex; align-items: center; justify-content: space-between; }
        .cart-header h2 { font-size: 24px; font-weight: 600; }
        .close-btn { background: var(--sand); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 20px; }

        .cart-items { flex: 1; overflow-y: auto; padding: 24px; }
        .cart-item { display: flex; gap: 16px; padding-bottom: 20px; margin-bottom: 20px; border-bottom: 1px solid var(--border-light); }
        .cart-item img { width: 80px; height: 80px; border-radius: 12px; object-fit: cover; background: var(--sand); }
        .cart-item-info { flex: 1; }
        .cart-item-info h4 { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .cart-item-info p { font-size: 13px; color: var(--gray); }

        .cart-footer { padding: 24px; background: var(--off-white); border-top: 1px solid var(--border-light); }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 8px; }
        .form-group input, .form-group textarea { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 12px; font-size: 15px; font-family: inherit; transition: border-color 0.2s; }
        .form-group input:focus { border-color: var(--ocean); outline: none; }
        
        .btn-submit { width: 100%; padding: 16px; background: var(--ocean); color: var(--white); border: none; border-radius: 14px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background 0.2s; margin-top: 8px; }
        .btn-submit:hover { background: #086a8a; }
        .btn-submit:disabled { background: var(--gray-light); cursor: not-allowed; }

        /* Confirmation Overlay */
        .conf-overlay { position: fixed; inset: 0; background: var(--white); z-index: 3000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; opacity: 0; visibility: hidden; transition: all 0.4s; }
        .conf-overlay.visible { opacity: 1; visibility: visible; }
        .conf-icon { width: 80px; height: 80px; background: var(--tropique); color: var(--white); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px; margin-bottom: 24px; }
        .conf-overlay h2 { font-size: 32px; margin-bottom: 12px; }
        .conf-overlay p { color: var(--gray); margin-bottom: 32px; font-size: 17px; max-width: 400px; }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <a href="#" class="logo" onclick="location.reload()">OLDA ATELIER</a>
            <button class="cart-toggle" onclick="openCart()">
                Panier <span class="cart-count" id="cart-count">0</span>
            </button>
        </div>
        <div class="nav-main-scroll">
            <nav class="nav-main" id="nav-main"></nav>
        </div>
        <div class="nav-sub-scroll">
            <nav class="nav-sub" id="nav-sub"></nav>
        </div>
    </header>

    <main>
        <div id="section-info" class="section-header"></div>
        <div class="product-grid" id="product-grid"></div>
    </main>

    <div class="modal-overlay" id="modal-overlay">
        <div class="cart-panel">
            <div class="cart-header">
                <h2>Votre Commande</h2>
                <button class="close-btn" onclick="closeCart()">×</button>
            </div>
            <div class="cart-items" id="cart-items-list"></div>
            <div class="cart-footer">
                <div class="form-group">
                    <label>Nom de l'établissement</label>
                    <input type="text" id="customer-name" placeholder="Ex: Grand Case Beach Club">
                </div>
                <div class="form-group">
                    <label>Email de contact</label>
                    <input type="email" id="customer-email" placeholder="votre@email.com">
                </div>
                <div class="form-group">
                    <label>Commentaires / Instructions</label>
                    <textarea id="customer-comment" rows="2" placeholder="Un message ?"></textarea>
                </div>
                <button class="btn-submit" id="cart-submit" onclick="submitOrder()">Confirmer la commande</button>
            </div>
        </div>
    </div>

    <div class="conf-overlay" id="conf-overlay">
        <div class="conf-icon">✓</div>
        <h2>Commande Envoyée</h2>
        <p>Merci ! Votre commande a été transmise à notre atelier. Nous vous contacterons très prochainement.</p>
        <button class="btn-submit" style="width: auto; padding: 12px 30px;" onclick="location.reload()">Retour à la boutique</button>
    </div>

    <script>
    (function() {
        const IMG = "https://olda.fr/wp-content/uploads/Boutique/IMG/";
        
        const DATA = [
            { key: "nouveautes", label: "Nouveautés", sub: [{ key: "arrivages", label: "Arrivages", items: [
                { name: "Support Mobile Acrylique", ref: "SM 01", img: IMG+"SM01.webp", qtyType: "default" },
                { name: "Bloc Note Similicuir", ref: "BNSA6", detail: "A6 (105 x 148)", img: IMG+"BNS.5.webp", qtyType: "blocnote" },
                { name: "Bloc Note Similicuir", ref: "BNS5", detail: "A5 (148 x 210)", img: IMG+"BNS.5.webp", qtyType: "blocnote" }
            ]}]},
            { key: "tasses", label: "Tasses", sub: [
                { key: "ceramique-fuck", label: "Tasse Céramique Fuck", items: [
                    { name: "Tasse Fuck", ref: "TCF 01", size: "350ml", color: "Rouge & Blanc", img: IMG+"TCF.01.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 02", size: "350ml", color: "Orange & Blanc", img: IMG+"TCF.02.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 03", size: "350ml", color: "Rose & Blanc", img: IMG+"TCF.03.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 04", size: "350ml", color: "Bleu & Blanc", img: IMG+"TCF.04.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 05", size: "350ml", color: "Vert & Blanc", img: IMG+"TCF.05.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 06", size: "350ml", color: "Noir & Blanc", img: IMG+"TCF.06.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 07", size: "350ml", color: "Blanc & Bleu", img: IMG+"TCF.07.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 08", size: "350ml", color: "Blanc & Jaune", img: IMG+"TCF.08.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 09", size: "350ml", color: "Blanc & Orange", img: IMG+"TCF.09.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 10", size: "350ml", color: "Blanc & Rouge", img: IMG+"TCF.10.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 11", size: "350ml", color: "Blanc & Vert", img: IMG+"TCF.11.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 12", size: "350ml", color: "Blanc & Noir", img: IMG+"TCF.12.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 13", size: "350ml", color: "Noir & Rose", img: IMG+"TCF.13.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 14", size: "350ml", color: "Noir & Jaune", img: IMG+"TCF.14.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 15", size: "350ml", color: "Noir & Rouge", img: IMG+"TCF.15.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 16", size: "350ml", color: "Noir & Vert", img: IMG+"TCF.16.webp", qtyType: "tasse" },
                    { name: "Tasse Fuck", ref: "TCF 17", size: "350ml", color: "Noir & Orange", img: IMG+"TCF.17.webp", qtyType: "tasse" }
                ]},
                { key: "ceramique", label: "Tasse Céramique", items: [
                    { name: "Tasse Céramique", ref: "TC 01", size: "350ml", color: "Rouge & Blanc", img: IMG+"TC.01.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 02", size: "350ml", color: "Orange & Blanc", img: IMG+"TC.02.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 03", size: "350ml", color: "Rose & Blanc", img: IMG+"TC.03.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 04", size: "350ml", color: "Bleu & Blanc", img: IMG+"TC.04.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 05", size: "350ml", color: "Vert & Blanc", img: IMG+"TC.05.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 06", size: "350ml", color: "Noir & Blanc", img: IMG+"TC.06.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 07", size: "350ml", color: "Blanc & Bleu", img: IMG+"TC.07.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 08", size: "350ml", color: "Blanc & Jaune", img: IMG+"TC.08.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 09", size: "350ml", color: "Blanc & Orange", img: IMG+"TC.09.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 10", size: "350ml", color: "Blanc & Rouge", img: IMG+"TC.10.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 11", size: "350ml", color: "Blanc & Vert", img: IMG+"TC.11.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 12", size: "350ml", color: "Blanc & Noir", img: IMG+"TC.12.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 13", size: "350ml", color: "Noir & Rose", img: IMG+"TC.13.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 14", size: "350ml", color: "Noir & Jaune", img: IMG+"TC.14.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 15", size: "350ml", color: "Noir & Rouge", img: IMG+"TC.15.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 16", size: "350ml", color: "Noir & Vert", img: IMG+"TC.16.webp", qtyType: "tasse" },
                    { name: "Tasse Céramique", ref: "TC 17", size: "350ml", color: "Noir & Orange", img: IMG+"TC.17.webp", qtyType: "tasse" }
                ]},
                { key: "metal", label: "Tasse Métal", items: [
                    { name: "Tasse Métal", ref: "TM 01", size: "300ml", color: "Blanc", img: IMG+"TM01.webp", qtyType: "tasse" },
                    { name: "Tasse Métal", ref: "TM 02", size: "300ml", color: "Bleu", img: IMG+"TM.02.webp", qtyType: "tasse" },
                    { name: "Tasse Métal", ref: "TM 03", size: "300ml", color: "Jaune", img: IMG+"TM.03.webp", qtyType: "tasse" },
                    { name: "Tasse Métal", ref: "TM 04", size: "300ml", color: "Rouge", img: IMG+"TM.04.webp", qtyType: "tasse" }
                ]}
            ]},
            { key: "goodies", label: "Goodies", sub: [
                { key: "porte-cles", label: "Porte-Clés", items: [
                    { name: "Porte-Clés Plexiglass", ref: "PCP 01", img: IMG+"PCP.01.webp", qtyType: "portecles" },
                    { name: "Porte-Clés Bois", ref: "PCPB 01", img: IMG+"PCB.01.webp", qtyType: "portecles" },
                    { name: "Porte-Clés Acrylique", ref: "PCA 01", img: IMG+"PCA.01.webp", qtyType: "portecles" },
                    { name: "Porte-Clés Flotteur Liège", ref: "PCFL 01", img: IMG+"PML01.webp", qtyType: "flotteur" }
                ]},
                { key: "magnets", label: "Magnets", items: [
                    { name: "Magnet Plexiglass", ref: "MP 01", img: IMG+"MP01.webp", qtyType: "magnet" },
                    { name: "Magnet Bois", ref: "MB 01", img: IMG+"MB.01.webp", qtyType: "magnet" },
                    { name: "Magnet Acrylique", ref: "MA 01", img: IMG+"MA.01.webp", qtyType: "magnet" }
                ]},
                { key: "stickers", label: "Stickers", items: [
                    { name: "Sticker", ref: "STI 01", detail: "75 x 75", img: IMG+"STI.01.webp", qtyType: "sticker" }
                ]}
            ]},
            { key: "sacs-pochettes", label: "Sacs & Pochettes", sub: [
                { key: "sacs", label: "Sacs", items: [
                    { name: "Sac de plage Naturel", ref: "S-001", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Sac de plage XL", ref: "S-002", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Sac Polochon en Molleton", ref: "S-003", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Tote Bag en Coton BIO", ref: "S-004", img: IMG+"PS.01.webp", qtyType: "default" }
                ]},
                { key: "pochettes", label: "Pochettes", items: [
                    { name: "Trousse de toilette", ref: "P-001", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette EarthAware Bio S", ref: "P-002", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette EarthAware Bio L", ref: "P-003", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette Zippée S", ref: "P-004", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette Zippée M", ref: "P-005", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette Vintage", ref: "P-006", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette Coton S", ref: "P-007", img: IMG+"PS.01.webp", qtyType: "default" },
                    { name: "Pochette Coton M", ref: "P-008", img: IMG+"PS.01.webp", qtyType: "default" }
                ]}
            ]},
            { key: "accessoires", label: "Accessoires", sub: [
                { key: "quotidien", label: "Quotidien", items: [
                    { name: "Porte sac", ref: "PS 01", img: IMG+"PS.01.webp", qtyType: "quotidien" },
                    { name: "Flasque Bois Clair", ref: "FBC 01", color: "Clair", img: IMG+"FBC.01.webp", qtyType: "quotidien" },
                    { name: "Flasque Bois Foncé", ref: "FBF 01", color: "Foncé", img: IMG+"FBF.01.webp", qtyType: "quotidien" },
                    { name: "Limonadier Bois Foncé", ref: "LBF 01", color: "Foncé", img: IMG+"LBF01.webp", qtyType: "quotidien" },
                    { name: "Limonadier Bois Clair", ref: "LBC 01", color: "Clair", img: IMG+"LBC01.webp", qtyType: "quotidien" },
                    { name: "Identificateur Valise Liège", ref: "IVL 01", img: IMG+"IVL.01.webp", qtyType: "quotidien" },
                    { name: "Petit Miroir Liège", ref: "PML 01", img: IMG+"PML01.webp", qtyType: "quotidien" },
                    { name: "Couteau Multi Bois", ref: "CMB 01", img: IMG+"CML.01.webp", qtyType: "quotidien" },
                    { name: "Pince à billet Argent", ref: "PBA 01", img: IMG+"PBA01.webp", qtyType: "quotidien" }
                ]},
                { key: "art-table", label: "Art de la Table", items: [
                    { name: "Bouchon Bois", ref: "BB 01", img: IMG+"BB.01.webp", qtyType: "bouchon" },
                    { name: "Dessous de plat Liège", ref: "DPL 01", img: IMG+"DPL.01.webp", qtyType: "dpl" },
                    { name: "Dessous de Verre Liège (par 1)", ref: "DVL 01", img: IMG+"DVL.01.webp", qtyType: "dvl" },
                    { name: "Plateau en Liège", ref: "PL 01", img: IMG+"PL.01.webp", qtyType: "quotidien" }
                ]},
                { key: "papeterie", label: "Papeterie & Impressions", items: [
                    { name: "Crayon papier bois", ref: "CPB 01", img: IMG+"CPB.01.webp", qtyType: "crayon" },
                    { name: "Stylo à bille en bois", ref: "SBB 01", img: IMG+"SBB.01.webp", qtyType: "stylo" },
                    { name: "Bloc Note Liège", ref: "BNLA6", detail: "A6 (105 x 148)", img: IMG+"BNLA6.webp", qtyType: "blocnote" },
                    { name: "Bloc Note Similicuir", ref: "BNSA6", detail: "A6 (105 x 148)", img: IMG+"BNS.5.webp", qtyType: "blocnote" },
                    { name: "Bloc Note Liège", ref: "BNLA5", detail: "A5 (148 x 210)", img: IMG+"BLCA5.webp", qtyType: "blocnote" },
                    { name: "Bloc Note Similicuir", ref: "BNSA5", color: "Bleu", detail: "A5 (148 x 210)", img: IMG+"BNS.5.webp", qtyType: "blocnote" },
                    { name: "Carte Postale", ref: "CPA6", detail: "A6 (105 x 148)", img: IMG+"CPA.6.webp", qtyType: "cartepostale" },
                    { name: "Affiche A3 + Tube", ref: "AFFA3", detail: "A3 (297 x 420)", img: IMG+"CPA.6.webp", qtyType: "affiche" }
                ]},
                { key: "jeux-loisirs", label: "Jeux & Loisirs", items: [
                    { name: "Morpion", ref: "MOR 01", img: IMG+"MOR.01.webp", qtyType: "jeux" },
                    { name: "Dominos", ref: "DOM 01", img: IMG+"DOM.01.webp", qtyType: "jeux" },
                    { name: "Mikado", ref: "MIK 01", img: IMG+"MIK.01.webp", qtyType: "jeux" },
                    { name: "Yoyo", ref: "YOY 01", img: IMG+"YOY.01.webp", qtyType: "jeux" },
                    { name: "Jeux de Cartes", ref: "JDC 01", img: IMG+"JDC.01.webp", qtyType: "jeux" },
                    { name: "Raquette Bois", ref: "RB 01", img: IMG+"RB01.webp", qtyType: "jeux" }
                ]},
                { key: "bijoux", label: "Bijoux", items: [
                    { name: "Bracelet en Acrylique", ref: "BA 01", img: IMG+"PCA.01.webp", qtyType: "jeux" }
                ]},
                { key: "decoration", label: "Décoration", items: [
                    { name: "Tableau Black A4", ref: "TBA4", img: IMG+"CPA.6.webp", qtyType: "tableau" },
                    { name: "Tableau Black A3", ref: "TBA3", img: IMG+"CPA.6.webp", qtyType: "tableau" }
                ]}
            ]},
            { key: "offres", label: "Offres Spéciales", isDiscount: true, sub: [{ key: "promo", label: "Promotions", items: [
                { name: "Porte Carte Liège", ref: "PCL 01", img: IMG+"PCL.01.webp", qtyType: "offre" },
                { name: "Couteau Multi Liège", ref: "CML 01", img: IMG+"CML.01.webp", qtyType: "offre" },
                { name: "Porte Monnaie Liège", ref: "PML 01", img: IMG+"PML01.webp", qtyType: "offre" },
                { name: "Boîte à bijoux en bois", ref: "BAB 01", img: IMG+"BAB01.webp", qtyType: "offre" },
                { name: "Décapsuleur Bois", ref: "DB 01", img: IMG+"LBC01.webp", qtyType: "offre" },
                { name: "Boîte à clic-clac", ref: "BCC 01", img: IMG+"BCC.01.webp", qtyType: "offre" },
                { name: "Cendrier Liège", ref: "CL 01", img: IMG+"CL.01.webp", qtyType: "offre" }
            ]}]}
        ];

        const QTY_CONFIGS = {
            tasse: { min: 6, step: 6 },
            portecles: { min: 10, step: 5 },
            magnet: { min: 10, step: 5 },
            sticker: { min: 50, step: 50 },
            bouchon: { min: 10, step: 1 },
            dpl: { min: 5, step: 1 },
            dvl: { min: 20, step: 1 },
            crayon: { min: 50, step: 50 },
            stylo: { min: 20, step: 1 },
            blocnote: { min: 10, step: 1 },
            cartepostale: { min: 100, step: 100 },
            affiche: { min: 10, step: 10 },
            quotidien: { min: 10, step: 1 },
            jeux: { min: 10, step: 1 },
            tableau: { min: 5, step: 1 },
            offre: { min: 1, step: 1 },
            default: { min: 10, step: 1 }
        };

        let currentMain = DATA[0].key;
        let currentSub = DATA[0].sub[0].key;
        let cart = [];

        const navMain = document.getElementById('nav-main');
        const navSub = document.getElementById('nav-sub');
        const productGrid = document.getElementById('product-grid');
        const sectionInfo = document.getElementById('section-info');
        const cartCount = document.getElementById('cart-count');
        const cartItemsList = document.getElementById('cart-items-list');
        const modalOverlay = document.getElementById('modal-overlay');
        const confOverlay = document.getElementById('conf-overlay');
        const customerName = document.getElementById('customer-name');
        const customerEmail = document.getElementById('customer-email');
        const customerComment = document.getElementById('customer-comment');
        const cartSubmit = document.getElementById('cart-submit');

        function renderNavMain() {
            navMain.innerHTML = DATA.map(cat => `
                <div class="nav-item ${cat.key === currentMain ? 'active' : ''} ${cat.isDiscount ? 'is-discount' : ''}" 
                     onclick="switchMain('${cat.key}')">${cat.label}</div>
            `).join('');
        }

        function renderNavSub() {
            const cat = DATA.find(c => c.key === currentMain);
            navSub.innerHTML = cat.sub.map(s => `
                <div class="sub-item ${s.key === currentSub ? 'active' : ''}" 
                     onclick="switchSub('${s.key}')">${s.label}</div>
            `).join('');
        }

        window.switchMain = (key) => {
            currentMain = key;
            currentSub = DATA.find(c => c.key === key).sub[0].key;
            renderNavMain(); renderNavSub(); renderProducts();
        };

        window.switchSub = (key) => {
            currentSub = key;
            renderNavSub(); renderProducts();
        };

        function renderProducts() {
            const cat = DATA.find(c => c.key === currentMain);
            const sub = cat.sub.find(s => s.key === currentSub);
            
            sectionInfo.innerHTML = `<h1>${sub.label}</h1><p>${cat.label} — Sélection Professionnelle</p>`;
            
            productGrid.innerHTML = sub.items.map(i => {
                const config = QTY_CONFIGS[i.qtyType] || QTY_CONFIGS.default;
                const cartItem = cart.find(ci => ci.ref === i.ref);
                const currentQty = cartItem ? cartItem.qty : 0;
                
                return `
                    <div class="card">
                        <div class="image-container">
                            <img src="${i.img}" alt="${i.name}" loading="lazy">
                        </div>
                        <div class="card-content">
                            <div class="product-ref">${i.ref}</div>
                            <div class="product-name">${i.name}</div>
                            <div class="product-detail">${i.detail || (i.size ? i.size + ' • ' + i.color : '')}</div>
                            <div class="qty-wrapper">
                                <div class="qty-step">Min. ${config.min} (par ${config.step})</div>
                                <div class="qty-input-group">
                                    <button class="qty-btn" onclick="updateQty('${i.ref}', -${config.step})">−</button>
                                    <input type="text" class="qty-value" value="${currentQty}" readonly>
                                    <button class="qty-btn" onclick="updateQty('${i.ref}', ${config.step})">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        window.updateQty = (ref, delta) => {
            const allItems = DATA.flatMap(c => c.sub.flatMap(s => s.items));
            const product = allItems.find(i => i.ref === ref);
            const config = QTY_CONFIGS[product.qtyType] || QTY_CONFIGS.default;
            
            let item = cart.find(i => i.ref === ref);
            if (!item) {
                if (delta > 0) {
                    cart.push({ ...product, qty: config.min });
                }
            } else {
                item.qty += delta;
                if (item.qty < config.min) {
                    cart = cart.filter(i => i.ref !== ref);
                }
            }
            updateCartUI();
            renderProducts();
        };

        function updateCartUI() {
            const total = cart.reduce((sum, i) => sum + i.qty, 0);
            cartCount.textContent = total;
            
            cartItemsList.innerHTML = cart.map(i => `
                <div class="cart-item">
                    <img src="${i.img}">
                    <div class="cart-item-info">
                        <h4>${i.name}</h4>
                        <p>Réf: ${i.ref} | Qté: <strong>${i.qty}</strong></p>
                        <p style="color:var(--ocean); cursor:pointer; margin-top:5px;" onclick="updateQty('${i.ref}', -9999)">Supprimer</p>
                    </div>
                </div>
            `).join('');
            
            cartSubmit.disabled = cart.length === 0;
        }

        window.openCart = () => modalOverlay.classList.add('visible');
        window.closeCart = () => modalOverlay.classList.remove('visible');

        window.submitOrder = () => {
            if (!customerName.value || !customerEmail.value) {
                alert("Merci de renseigner votre établissement et votre email.");
                return;
            }

            const orderNumber = Math.floor(1000 + Math.random() * 9000);
            const orderTableRows = cart.map(i => {
                const spec = i.detail || (i.size ? i.size + ' - ' + i.color : '-');
                return `<tr><td style="padding:8px; border-bottom:1px solid #eee;">${i.name}</td><td style="padding:8px; border-bottom:1px solid #eee;">${i.ref}</td><td style="padding:8px; border-bottom:1px solid #eee;">${spec}</td><td style="padding:8px; border-bottom:1px solid #eee; font-weight:bold;">${i.qty}</td></tr>`;
            }).join('');

            const templateParams = {
                order_number: orderNumber,
                customer_name: customerName.value,
                customer_email: customerEmail.value,
                customer_comment: customerComment.value || 'Aucun commentaire',
                order_table_rows: orderTableRows,
                total_items: cart.reduce((sum, i) => sum + i.qty, 0)
            };

            cartSubmit.disabled = true;
            cartSubmit.textContent = "Envoi en cours...";

            emailjs.init("Y9NKwhNvCNtb_SRry");
            emailjs.send("service_1cvmozk", "template_ptouuob", templateParams)
                .then(() => {
                    closeCart();
                    confOverlay.classList.add('visible');
                    cart = [];
                    updateCartUI();
                }, (error) => {
                    alert("Erreur lors de l'envoi. Veuillez réessayer.");
                    cartSubmit.disabled = false;
                    cartSubmit.textContent = "Confirmer la commande";
                });
        };

        renderNavMain(); renderNavSub(); renderProducts();
    })();
    </script>
</body>
</html>
